/**
 * Sistema de Traduções Manual
 * Traduções customizadas para o portfólio
 */

const translations = {
    pt: {
        // Navigation
        'nav.online': 'ONLINE',
        'nav.development': 'DESENVOLVIMENTO',
        'nav.about': 'SOBRE',
        'nav.contact': 'CONTATO',
        
        // Hero Section
        'hero.title': 'DESENVOLVEDOR CLOUD',
        'hero.description': 'O que realmente importa não é quantas tecnologias eu domino, mas a segurança e a clareza com que entrego soluções que funcionam.',
        'hero.portfolio': 'VER PORTFÓLIO',
        'hero.contact': 'CONTATE-ME',
        
        // Projects
        'projects.online.title': 'PROJETOS ONLINE',
        'projects.development.title': 'PROJETOS EM DESENVOLVIMENTO',
        'projects.view': 'Ver Site',
        'projects.details': 'Detalhes',
        'projects.demo': 'Ver Demo',
        'projects.inprogress': 'Em Desenvolvimento',
        
        // About
        'about.title': 'SOBRE MIM',
        'about.description1': 'Sou desenvolvedor web e profissional de tecnologia com foco em soluções em nuvem (AWS), com experiência prática em projetos envolvendo arquitetura serverless, automação com Python e integrações modernas para aplicações web.',
        'about.description2': 'Antes de atuar na área de tecnologia, trabalhei por mais de 10 anos em setores de administração, controle de processos e atendimento ao cliente, o que me desenvolveu habilidades sólidas em organização, gestão de demandas e comunicação com equipes multidisciplinares.',
        'about.description3': 'Hoje, aplico esse conhecimento não apenas para desenvolver soluções eficientes, mas para entender o impacto que a tecnologia precisa gerar no negócio do cliente — seja otimizando fluxos, criando aplicações performáticas ou propondo arquiteturas seguras e escaláveis.',
        'about.mission': 'Minha missão: unir minha experiência técnica à minha vivência prática com gestão e processos para entregar soluções de tecnologia que geram valor real e medido.',
        'about.education': 'Formação Acadêmica',
        'about.certifications': 'Certificações',
        'about.skills': 'Habilidades',
        'about.journey': 'Minha Jornada Profissional',
        'about.journey.description': 'Antes de ingressar na tecnologia, atuei em áreas administrativas, gestão de processos e atendimento ao cliente, onde desenvolvi habilidades de liderança, organização e foco em resultados. Essas experiências me permitem hoje unir visão técnica com visão de negócios, entendendo melhor as dores e objetivos de cada projeto.',
        'about.certificates.button': 'Ver Todos os Certificados',
        
        // Contact
        'contact.title': 'CONTATO',
        'contact.subtitle': 'Vamos conversar',
        'contact.description': 'Estou disponível para novos projetos, consultorias e oportunidades de trabalho. Entre em contato para conversarmos!',
        'contact.email': 'Email',
        'contact.phone': 'Telefone',
        'contact.social': 'Redes Sociais',
        'contact.location': 'Localização',
        'contact.form.name': 'Nome',
        'contact.form.email': 'Email',
        'contact.form.subject': 'Assunto',
        'contact.form.message': 'Mensagem',
        'contact.form.send': 'ENVIAR MENSAGEM',
        'contact.form.name.placeholder': 'Seu nome',
        'contact.form.email.placeholder': 'seu.email@exemplo.com',
        'contact.form.subject.placeholder': 'Assunto da mensagem',
        'contact.form.message.placeholder': 'Sua mensagem...',
        
        // Certificates
        'certificates.title': 'CERTIFICADOS E BADGES',
        'certificates.filter': 'Filtrar por categoria',
        'certificates.all': 'Todas as categorias',
        'certificates.aws.title': 'Certificações AWS',
        'certificates.education.title': 'Certificados Educacionais',
        'certificates.back': 'Voltar para a página inicial',
        'certificates.inprogress': 'Em Progresso',
        'certificates.expected': 'Previsão',
        'certificates.ongoing': 'Em andamento',
        
        // Footer
        'footer.rights': 'Todos os direitos reservados.',
        
        // Project Details
        'project.back': 'Voltar para a página inicial',
        'project.info': 'Informações do Projeto',
        'project.category': 'Categoria',
        'project.client': 'Cliente',
        'project.date': 'Data',
        'project.technologies': 'Tecnologias',
        'project.description': 'Descrição',
        'project.features': 'Funcionalidades',
        'project.notfound': 'Projeto não encontrado',
        'project.notfound.description': 'O projeto que você está procurando não existe ou foi removido.',
        
        // Error Page
        'error.title': 'Página não encontrada | Sergio Sena',
        'error.heading': 'Página não encontrada',
        'error.description': 'A página que você está procurando não existe ou foi movida.',
        'error.home': 'Voltar ao Início',
        'error.projects': 'Ver Projetos',
        'error.explore': 'Ou explore outras seções:',
        'error.certificates': 'Certificados',
        
        // Language
        'lang.button': 'View in English',
        
        // Project Details Page
        'project.title': 'Detalhes do Projeto | Sergio Sena'
    },
    
    en: {
        // Navigation
        'nav.online': 'ONLINE',
        'nav.development': 'DEVELOPMENT',
        'nav.about': 'ABOUT',
        'nav.contact': 'CONTACT',
        
        // Hero Section
        'hero.title': 'CLOUD DEVELOPER',
        'hero.description': 'What really matters is not how many technologies I master, but the security and clarity with which I deliver solutions that work.',
        'hero.portfolio': 'VIEW PORTFOLIO',
        'hero.contact': 'CONTACT ME',
        
        // Projects
        'projects.online.title': 'ONLINE PROJECTS',
        'projects.development.title': 'DEVELOPMENT PROJECTS',
        'projects.view': 'View Site',
        'projects.details': 'Details',
        'projects.demo': 'View Demo',
        'projects.inprogress': 'In Development',
        
        // About
        'about.title': 'ABOUT ME',
        'about.description1': 'I am a web developer and technology professional focused on cloud solutions (AWS), with practical experience in projects involving serverless architecture, Python automation, and modern integrations for web applications.',
        'about.description2': 'Before working in technology, I worked for over 10 years in administration, process control, and customer service sectors, which developed solid skills in organization, demand management, and communication with multidisciplinary teams.',
        'about.description3': 'Today, I apply this knowledge not only to develop efficient solutions, but to understand the impact that technology needs to generate on the client\'s business — whether optimizing flows, creating performant applications, or proposing secure and scalable architectures.',
        'about.mission': 'My mission: combine my technical experience with my practical experience in management and processes to deliver technology solutions that generate real and measured value.',
        'about.education': 'Academic Background',
        'about.certifications': 'Certifications',
        'about.skills': 'Skills',
        'about.journey': 'My Professional Journey',
        'about.journey.description': 'Before entering technology, I worked in administrative areas, process management, and customer service, where I developed leadership, organization, and results-focused skills. These experiences allow me today to combine technical vision with business vision, better understanding the pain points and objectives of each project.',
        'about.certificates.button': 'View All Certificates',
        
        // Contact
        'contact.title': 'CONTACT',
        'contact.subtitle': 'Let\'s talk',
        'contact.description': 'I am available for new projects, consulting, and job opportunities. Get in touch so we can talk!',
        'contact.email': 'Email',
        'contact.phone': 'Phone',
        'contact.social': 'Social Media',
        'contact.location': 'Location',
        'contact.form.name': 'Name',
        'contact.form.email': 'Email',
        'contact.form.subject': 'Subject',
        'contact.form.message': 'Message',
        'contact.form.send': 'SEND MESSAGE',
        'contact.form.name.placeholder': 'Your name',
        'contact.form.email.placeholder': 'your.email@example.com',
        'contact.form.subject.placeholder': 'Message subject',
        'contact.form.message.placeholder': 'Your message...',
        
        // Certificates
        'certificates.title': 'CERTIFICATES AND BADGES',
        'certificates.filter': 'Filter by category',
        'certificates.all': 'All categories',
        'certificates.aws.title': 'AWS Certifications',
        'certificates.education.title': 'Educational Certificates',
        'certificates.back': 'Back to homepage',
        'certificates.inprogress': 'In Progress',
        'certificates.expected': 'Expected',
        'certificates.ongoing': 'Ongoing',
        
        // Footer
        'footer.rights': 'All rights reserved.',
        
        // Project Details
        'project.back': 'Back to homepage',
        'project.info': 'Project Information',
        'project.category': 'Category',
        'project.client': 'Client',
        'project.date': 'Date',
        'project.technologies': 'Technologies',
        'project.description': 'Description',
        'project.features': 'Features',
        'project.notfound': 'Project not found',
        'project.notfound.description': 'The project you are looking for does not exist or has been removed.',
        
        // Error Page
        'error.title': 'Page not found | Sergio Sena',
        'error.heading': 'Page not found',
        'error.description': 'The page you are looking for does not exist or has been moved.',
        'error.home': 'Back to Home',
        'error.projects': 'View Projects',
        'error.explore': 'Or explore other sections:',
        'error.certificates': 'Certificates',
        
        // Language
        'lang.button': 'Ver em Português',
        
        // Project Details Page
        'project.title': 'Project Details | Sergio Sena'
    }
};

// Sistema de detecção de idioma
class LanguageSystem {
    constructor() {
        this.currentLang = 'pt';
        this.init();
    }
    
    async init() {
        try {
            // 1. Verificar preferência salva
            const savedLang = localStorage.getItem('portfolio-lang');
            if (savedLang) {
                this.currentLang = savedLang;
                this.applyTranslations();
                this.updateToggleButton();
                return;
            }
            
            // 2. Detectar localização com timeout
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000);
                
                const response = await fetch('https://ipapi.co/json/', {
                    signal: controller.signal
                });
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const data = await response.json();
                    this.currentLang = data.country_code === 'BR' ? 'pt' : 'en';
                } else {
                    throw new Error('API response not ok');
                }
            } catch (error) {
                // 3. Fallback: português como padrão
                this.currentLang = 'pt';
            }
            
            this.applyTranslations();
            this.updateToggleButton();
        } catch (error) {
            console.warn('Translation system error:', error);
            // Fallback silencioso - site funciona em português
            this.currentLang = 'pt';
        }
    }
    
    toggleLanguage() {
        this.currentLang = this.currentLang === 'pt' ? 'en' : 'pt';
        localStorage.setItem('portfolio-lang', this.currentLang);
        this.applyTranslations();
        this.updateToggleButton();
    }
    
    applyTranslations() {
        // Traduzir elementos com data-translate
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = translations[this.currentLang][key];
            if (translation) {
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translation;
                } else {
                    element.textContent = translation;
                }
            }
        });
        
        // Traduzir projetos
        const projectElements = document.querySelectorAll('[data-project]');
        projectElements.forEach(element => {
            const projectId = element.getAttribute('data-project');
            const field = element.getAttribute('data-field');
            
            if (window.projectsTranslations && projectId && field) {
                const projectData = window.projectsTranslations[this.currentLang][projectId];
                if (projectData && projectData[field]) {
                    element.textContent = projectData[field];
                }
            }
        });
        
        // Traduzir título da página
        const titleElement = document.querySelector('title[data-translate]');
        if (titleElement) {
            const key = titleElement.getAttribute('data-translate');
            const translation = translations[this.currentLang][key];
            if (translation) {
                document.title = translation;
            }
        }
        
        // Atualizar HTML lang
        document.documentElement.lang = this.currentLang === 'pt' ? 'pt-BR' : 'en';
    }
    
    updateToggleButton() {
        // Atualizar botão mobile
        const buttonText = document.getElementById('langText');
        if (buttonText) {
            buttonText.textContent = translations[this.currentLang]['lang.button'];
        }
        
        // Atualizar botão desktop
        const buttonTextDesktop = document.getElementById('langTextDesktop');
        if (buttonTextDesktop) {
            buttonTextDesktop.textContent = translations[this.currentLang]['lang.button'];
        }
    }
}

// Inicializar sistema com fallback
let languageSystem;

function initializeTranslations() {
    try {
        languageSystem = new LanguageSystem();
        window.languageSystem = languageSystem;
    } catch (error) {
        console.warn('Translation system failed to initialize:', error);
        // Site funciona normalmente sem traduções
    }
}

// Múltiplos pontos de inicialização
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeTranslations);
} else {
    initializeTranslations();
}

// Fallback adicional
window.addEventListener('load', () => {
    if (!window.languageSystem) {
        initializeTranslations();
    }
});

// Função global segura
window.toggleLanguage = function() {
    try {
        if (window.languageSystem) {
            window.languageSystem.toggleLanguage();
        }
    } catch (error) {
        console.warn('Toggle language failed:', error);
    }
};

// Exportar para uso global
if (typeof window !== 'undefined') {
    window.translations = translations;
}